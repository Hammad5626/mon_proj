  <div class="container mt-5">
    <div id="chartDiv" style="width: 100%; height: calc(100vh - 100px);"></div>
  </div>

  <style>
    .amcharts-graph-balanceseries .amcharts-graph-stroke {
      stroke: #1f77b4;
      stroke-width: 2px;
    }

    .amcharts-graph-averageseries .amcharts-graph-stroke {
      stroke: #ff7f0e;
      stroke-width: 2px;
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let contextData = JSON.parse('{{ context_json|safe }}');
      let profitList = contextData.profit_list;
      let openingTimeList = contextData.opening_time_list;
      let startingBalance = 100;
      let totalBalance = [startingBalance];
      let averageBalance = [startingBalance];

      let chart = am4core.create("chartDiv", am4charts.XYChart);
      chart.width = am4core.percent(100);
      chart.height = am4core.percent(100);

      for (let i = 0; i < profitList.length; i++) {
        let currentBalance = totalBalance[i] + profitList[i];
        totalBalance.push(currentBalance);

        let sum = totalBalance.reduce((acc, val) => acc + val, 0);
        let average = sum / (i + 1);
        averageBalance.push(average);
      }

      chart.data = openingTimeList.map((openingTime, index) => ({
        category: openingTime,
        balance: totalBalance[index],
        average: averageBalance[index]
      }));

      let categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
      categoryAxis.dataFields.category = "category";

      let valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

      let balanceSeries = chart.series.push(new am4charts.LineSeries());
      balanceSeries.dataFields.valueY = "balance";
      balanceSeries.dataFields.categoryX = "category";
      balanceSeries.strokeWidth = 2;
      balanceSeries.stroke = am4core.color("#1f77b4");

      let averageSeries = chart.series.push(new am4charts.LineSeries());
      averageSeries.dataFields.valueY = "average";
      averageSeries.dataFields.categoryX = "category";
      averageSeries.strokeWidth = 2;
      averageSeries.stroke = am4core.color("#ff7f0e");

      chart.legend = new am4charts.Legend();

      let scrollbarX = new am4core.Scrollbar();
      chart.scrollbarX = scrollbarX;

      // Enable tooltips
      chart.cursor = new am4charts.XYCursor();
      chart.cursor.behavior = "zoomXY";
      chart.cursor.snapToSeries = [balanceSeries, averageSeries];

      let drawChart = () => {
        chart.width = am4core.percent(100);
      };

      drawChart();
    });
  </script>